From 7571ce90ed2e3866f877da17ec17f963fb0ea410 Mon Sep 17 00:00:00 2001
From: Stanislav Ochotnicky <sochotnicky@redhat.com>
Date: Mon, 9 Jan 2012 10:11:51 +0100
Subject: [PATCH 1/4] Use plexus-component-metadata

---
 doxia-modules/doxia-module-apt/pom.xml            |    9 +++++----
 doxia-modules/doxia-module-docbook-simple/pom.xml |    7 ++++---
 doxia-modules/doxia-module-fml/pom.xml            |    7 ++++---
 doxia-modules/doxia-module-xdoc/pom.xml           |    7 ++++---
 pom.xml                                           |    6 +++---
 5 files changed, 20 insertions(+), 16 deletions(-)

diff --git a/doxia-modules/doxia-module-apt/pom.xml b/doxia-modules/doxia-module-apt/pom.xml
index b7ccd9d..12106b0 100644
--- a/doxia-modules/doxia-module-apt/pom.xml
+++ b/doxia-modules/doxia-module-apt/pom.xml
@@ -53,21 +53,22 @@ under the License.
     <plugins>
       <plugin>
         <groupId>org.codehaus.plexus</groupId>
-        <artifactId>plexus-maven-plugin</artifactId>
+        <artifactId>plexus-component-metadata</artifactId>
         <configuration>
           <descriptors>
             <descriptor>src/main/components/components.xml</descriptor>
-            <descriptor>target/generated-resources/plexus/META-INF/plexus/components.xml</descriptor>
+	    <descriptor>target/classes/META-INF/plexus/components.xml</descriptor>
           </descriptors>
         </configuration>
         <executions>
           <execution>
             <goals>
-              <goal>merge-descriptors</goal>
+              <goal>generate-metadata</goal>
+              <goal>merge-metadata</goal>
             </goals>
           </execution>
         </executions>
       </plugin>
     </plugins>
   </build>
-</project>
\ No newline at end of file
+</project>
diff --git a/doxia-modules/doxia-module-docbook-simple/pom.xml b/doxia-modules/doxia-module-docbook-simple/pom.xml
index ebd2c24..34256cb 100644
--- a/doxia-modules/doxia-module-docbook-simple/pom.xml
+++ b/doxia-modules/doxia-module-docbook-simple/pom.xml
@@ -49,17 +49,18 @@ under the License.
     <plugins>
       <plugin>
         <groupId>org.codehaus.plexus</groupId>
-        <artifactId>plexus-maven-plugin</artifactId>
+        <artifactId>plexus-component-metadata</artifactId>
         <configuration>
           <descriptors>
             <descriptor>src/main/components/components.xml</descriptor>
-            <descriptor>target/generated-resources/plexus/META-INF/plexus/components.xml</descriptor>
+            <descriptor>target/classes/META-INF/plexus/components.xml</descriptor>
           </descriptors>
         </configuration>
         <executions>
           <execution>
             <goals>
-              <goal>merge-descriptors</goal>
+              <goal>generate-metadata</goal>
+              <goal>merge-metadata</goal>
             </goals>
           </execution>
         </executions>
diff --git a/doxia-modules/doxia-module-fml/pom.xml b/doxia-modules/doxia-module-fml/pom.xml
index 3a85888..84aa766 100644
--- a/doxia-modules/doxia-module-fml/pom.xml
+++ b/doxia-modules/doxia-module-fml/pom.xml
@@ -81,17 +81,18 @@ under the License.
       </plugin>
       <plugin>
         <groupId>org.codehaus.plexus</groupId>
-        <artifactId>plexus-maven-plugin</artifactId>
+        <artifactId>plexus-component-metadata</artifactId>
         <configuration>
           <descriptors>
             <descriptor>src/main/components/components.xml</descriptor>
-            <descriptor>target/generated-resources/plexus/META-INF/plexus/components.xml</descriptor>
+            <descriptor>target/classes/META-INF/plexus/components.xml</descriptor>
           </descriptors>
         </configuration>
         <executions>
           <execution>
             <goals>
-              <goal>merge-descriptors</goal>
+              <goal>generate-metadata</goal>
+              <goal>merge-metadata</goal>
             </goals>
           </execution>
         </executions>
diff --git a/doxia-modules/doxia-module-xdoc/pom.xml b/doxia-modules/doxia-module-xdoc/pom.xml
index 1e8acfb..4e59f87 100644
--- a/doxia-modules/doxia-module-xdoc/pom.xml
+++ b/doxia-modules/doxia-module-xdoc/pom.xml
@@ -72,17 +72,18 @@ under the License.
       </plugin>
       <plugin>
         <groupId>org.codehaus.plexus</groupId>
-        <artifactId>plexus-maven-plugin</artifactId>
+        <artifactId>plexus-component-metadata</artifactId>
         <configuration>
           <descriptors>
             <descriptor>src/main/components/components.xml</descriptor>
-            <descriptor>target/generated-resources/plexus/META-INF/plexus/components.xml</descriptor>
+            <descriptor>target/classes/META-INF/plexus/components.xml</descriptor>
           </descriptors>
         </configuration>
         <executions>
           <execution>
             <goals>
-              <goal>merge-descriptors</goal>
+              <goal>generate-metadata</goal>
+              <goal>merge-metadata</goal>
             </goals>
           </execution>
         </executions>
diff --git a/pom.xml b/pom.xml
index 4eff88e..fe06199 100644
--- a/pom.xml
+++ b/pom.xml
@@ -285,7 +285,7 @@ under the License.
         </plugin>
         <plugin>
           <groupId>org.codehaus.plexus</groupId>
-          <artifactId>plexus-maven-plugin</artifactId>
+          <artifactId>plexus-component-metadata</artifactId>
           <!-- Version 1.3.8 makes the descriptor merges fail, probably due to PLX-409 -->
           <version>1.3.5</version>
         </plugin>
@@ -333,11 +333,11 @@ under the License.
     <plugins>
       <plugin>
         <groupId>org.codehaus.plexus</groupId>
-        <artifactId>plexus-maven-plugin</artifactId>
+        <artifactId>plexus-component-metadata</artifactId>
         <executions>
           <execution>
             <goals>
-              <goal>descriptor</goal>
+              <goal>generate-metadata</goal>
             </goals>
           </execution>
         </executions>
-- 
1.7.7.4

